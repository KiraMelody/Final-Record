# **数字信号处理与语音信号分析**

xyxue@fudan.edu.cn

期末考试（50分）

- 闭卷
- 信号与系统
- 数字信号处理
- 模式识别及机器学习
- 语音信号
- - 语音信号产生
  - 人类听觉机理
- 语音分析
- - 线性语音产生模型
  - 语音信号特征分析
- 语音识别
- - 话音识别
  - 说话人识别

课程项目（40分）

- 编程实现课程项目，系统演示，提交书面报告

话音识别：30个以上单词短语

成绩标准（Matlab）

1. 研究内容越多，成绩越好
2. 识别性能越好，成绩越好
3. 项目核心代码，自己编写

学习态度（10分）

- 平时成绩

- 缺席一次扣2分

  ​

## 基础知识

- ### 信号与系统

信号的描述

- 信号可表示为一个或多个自变量的函数

一维语音信号／多维图像信号

立体声：多通道（每个通道都是一维）

- 信号自变量用时间t（连续）或序号k（离散）表示

正弦波信号$x(t) = Acos(\omega_0t + \lambda)$

连续时间信号

- 时间和幅度均连续的信号，又称模拟信号 anolog signal

单位阶跃

![](1.png)

单位冲激 （可视为面积为1的方形）（取值无限大）

![](2.png)

- 连续时间单位阶跃与单位冲激信号

  ![](3.png)

- 信号延迟

- 冲激函数的性质

1. 抽样性

2. 奇偶性

3. 比例性

4. 卷积性质

   ![](4.png)

**任何一个函数和冲激函数卷积都是他自己**

- 离散时间信号

一维离散时间信号：在不离散的时刻k有函数值，在其他时刻并无定义

离散时间信号：通常按时间顺序的一组数值，也称时间序列

抽样信号：离散时间信号的幅值是连续的

数字信号：时间离散，幅度离散（用有限长的小数表示信号）（计算机存储都是数字信号）

- 单位采样序列

可以用来表示任意序列（卷积）
$$
x(n) = \sum_{m=-\infty}^{+\infty} x(m)\delta(n-m)
$$

- 单位阶跃序列（1，0）
- 互相关系

$$
\delta(n) = u(n) - u(n-1)\\
u(n) = \sum_{m=-\infty}^{n}\delta(m)
$$

- 矩形序列
- 实指数序列
- 周期信号与非周期信号

周期信号是指经过一定时间重复出现的信号

非周期信号在时间上不具有终而复始的特性（周期趋向于无穷大）

- 周期序列$x(n) = x(n+N)$
- $cos(\frac{n}{5})$周期为无理数 非周期信号
- 能量信号与功率信号

能量信号：信号总能量为有限制而信号平均功率为零

功率信号：信号平均功率为有限制而信号总能量为无限大

一个信号不可能既是功率信号，又是能量信号，但可以都不是

周期信号都是功率信号，非周期信号可能是能量信号，也可能是功率信号。

- 连续时间信号运算

基本运算：加减乘除微分积分

- 任意信号可分解为偶分量（关于y轴对称）和奇分量（关于原点对称）之和
- 调幅（改变a）：两个信号相乘的新信号，他在任意时刻的值等于这两个信号在该时刻的值得积
- 收音机：调幅（乘高频载波）到了收音机再抽出低频信号
- 信号经微分运算后，凸显了信号的变化部分，当f(t)中含有间断点时，f(t)在这些点仍有导数即冲击响应
- 积分运算可削弱毛刺噪声的影响

信号波形变换：波形的翻转、平移和展缩等

反转：f(t)与f(-t)以纵轴镜像对称

平移：f(t-b) b>0 f(t)右移b

尺度变换：f(at) a为常数 |a|>1表示波形在时间轴上压缩1/|a|倍，|a|<1表示波形在时间轴上扩展|a|倍

- x(2n)对x(n)为抽样，x(n/2)为插0
- 系统

是一个有若干互有关联的单元组成的有机整体，具有某种功能

输入激励→系统（转换）→输出响应

连续时间系统：微分方程

离散时间系统：差分方程

混合系统：两种系统组合运用

- 线性系统与非线性系统

线性系统：是指满足齐次性和叠加性的系统

齐次性：输入改变k倍，输出也改变k倍

叠加性$T[e1(t)+e2(t)] = T[e1(t)]+T(e2(t))$

- 时不变系统与时变系统

若构成系统的元器参数不随时间而变化，则称此系统为时不变系统

$r(t) = T[e(t)]$ 则 $r(t-t0) = T[e(t-t0)]$

线性与时变是两个互不相关的概念

- 因果系统与非因果系统

因果系统是指系统在to时刻的响应应只取决于t = t0 和 t < t0是的输入，而与t > t0的输入无关

一般而言，任何物理可实现系统都具有因果性

常取t=0为初始值

- 稳定系统与不稳定系统

如果系统对任意有界输入都只产生有界输出，则称该系统为有界输入有界输出系统

闭环 = 反馈

差分方程：递推求解（边界值和递推条件）

- 卷积

任何连续时间信号x(t)都可以被分解成加权时间冲激信号求和

若系统是线性时不变的，系统所有特性h(t)定义，$y(t) = x(t) * h(t)$

已知x,y求h

这种求系统相应的运算关旭称为卷积积分



### 复习

两个系统（线性、时移不变、稳定、因果）串联：线性、时移不变、稳定、因果

两个非线性系统串联可能是线性
$$
w(n) = e^{x(n)} \\
y(n) = log{w(n)}
$$
计算卷积

连续：翻转平移求积分

离散：求和



### 傅里叶级数

定义：设周期信号为$f(x)$，其周期是$T$，角频率$\omega$为$$\omega = \frac{2\pi}{T}$$，称为基频

满足**狄利克雷条件**时，可展成![](5.png)

n为倍数，n=1一次谐波，n=2两次谐波

取等号的要求是有无穷多项（严格相等）

根据三角函数系的**正交性**

解得![](6.png)

傅里叶级数展开只需求一个周期

任何一个矩形波都能分解成无穷多个正弦波的叠加

时间信号经过傅里叶级数展开，可以画成频谱图（时域 到 频域）

### 傅里叶级数的复数形式

存在复数形式的信号

![](7.png)

非周期信号——T变成无限大（频谱$\omega$无限小，变成连续的），对应连续谱，间隔变小，能量变小。**绝对幅度无限小，但有相对大小，引入频谱密度函数。**

周期信号——对应离散谱

实函数可以由幅度谱构建出来

无穷多个振幅为无穷小的连续余弦信号之和，频域范围：$0 \to \infty$

### 傅里叶正负变换

![](8.png)

### 矩形脉冲信号的傅里叶变换

==时间域有限长，到频域所包含无限多频率成分==

==频率越大，能量越大==

闪电包含的频率成分非常多

$Sa(x) = \frac{sin(x)}{x}$

![](8_1.png)

### 升余弦脉冲信号的傅里叶变换

信号很难一起处理，分开相当于加矩形框，时域相乘，等于频域卷积

取一段语音，就是用**这个信号**乘定长时间

特点：幅度集中，能量溢散快，其频谱比矩形脉冲更集中

相乘之后，外面没了，里面保留

矩形波跳变处，有无穷多频率分量，能量比较多

矩形波：$\omega$大的地方，高频多，能量大

升余弦：$\omega$小的地方，高频少，能量小，衰减快

耳朵：300-3400Hz

### 冲激函数$\delta(t)$的傅里叶变换

所有的频率都有谱且值相同$F(\omega) = 1$

### 余弦信号的傅里叶变换

余弦信号的谱线是两根线，在$\pm\omega_0$处

### 卷积定理

![](9.png)

==时域卷积等于频域相乘，时域相乘等价于频域卷积==

一个是以不变的信息系统，在频域是输入信号的傅里叶变换和转移函数的傅里叶变换相乘，再反变换。

**时域窗口不合适，频域不合适**

![](10.png)

$\omega_0$远远大于我的语音信号的$\omega$（300-3400Hz）

空中传播的调幅信号的铺如上$F(\omega)$，非常高频

调制：$G(\omega)$往$\pm\omega_0$搬

解调：把这个谱再去乘$cos(\omega_0t)$，取最低成分信号（低通滤波器）

**例.已知$f_1(t) \leftrightarrow E\tau Sa(\frac{\omega\tau}{2})$，求$f(t) = f_1(t) * f_1(t)$的频谱密度函数$F(\omega)$**

#### Gibbs效应

在跳变处，取频率分量越多，跳变越快（方波边越清晰），震荡越集中。重构项选的越多，震荡越小。因为忽略了无穷多分量的某一些，只要不是无穷项，一定会在跳变处（方波的边）有一个震荡。一般来讲不超过10%。

### 傅里叶变换的性质

- 对称性

  时域与频域可以互相变换（频域函数用到时域，获得的频域等于原时域）

- 时移

  时移$x(t-t_0)$相当于相移

- 能量守恒

  时域能量等于频域能量

- 尺度变换性

  信号在时域中压缩，等效于在频域中扩展

  信号在时域中扩展，等效于在频域中压缩

- 微分性质

- ==卷积性质==证明

  时域相乘 等于 频域卷积

### 模拟信号数字化

1. 时间抽样
2. 抽样定理
3. 频域抽样
4. 信号回复
5. 幅值量化

模拟信号： 讲话 推动电压变化 时间幅值都连续

采样Sampling：在某些离散时间点上提取连续时间信号值的过程称为抽样

#### 抽样定理

如果不加限制，从连续时间信号抽样所得的样本序列不能唯一代表原来的连续时间信号

对于同一个连续时间信号，当抽样间隔不同时，也会得到不同的样本序列

时域：$x_p(t) = x(t) \times p(t)$

频域：$X_p(j\omega) = \frac{1}{2 \pi} X(j\omega) * P(j\omega)$

理想采样(乘 冲激函数)

$p(t) = \sum_{n=-\infty}^{\infty}\delta(t-nT)$

$x_p(t) = \sum_{n=-\infty}^{\infty}x(nT)\delta(t-nT)$

自然采样

$\tau$不可能为0，一定有宽度

#### 时域采样

理想采样等幅度，采样有宽度，则幅度Sa控制，不相等

==将频域做周期拓延==

**Nyquist**抽样定理

对最高频率为$\omega_M$的连续时间信号$x(t)$，如果以$\omega_S \ge 2\omega_M$的频率进行理想采样，则x(t)可以由x(nT)确定

==确保不叠加==

人一般是3.4KHz，所以抽样一般是8Hz

自然采样，矩形脉冲Sa函数控制包络

#### 结论

不管是矩形脉冲抽样还是冲激抽样，抽样后信号频谱是离散周期的信号，周期为$\omega_s = \frac{2\pi}{T_s}$

对于矩形脉冲抽样，其频谱的幅度随Sa函数变化

对于冲激抽样，其频谱的幅度为常数

#### 频域抽样

对连续的信号频谱$F(w) \to \delta(w) \to F1(w)$

==时间域周期拓延==

#### 从抽样信号中恢复原信号

滤波：在频域用矩形窗口取出一部分（低通滤波器）

为什么$\omega_S \ge 2\omega_M$，保证不能干扰，互相分离，可以滤波

矩形脉冲是无限的，不能知道最高频率，所以恢复时一定不能完全恢复成矩形

一般来说，发音频率有限制，不会到无限频率

离散时间符号的幅度离散化

- C/D转换器：幅度精度无限→尽管信号是离散的，但幅度是连续的
- 实际设备无法达到无限精度，因此作为C/D转换器的近似，C/D转换器产生的数字信号在时间和幅度上都是离散的

#### 量化误差统计分布

量化噪声$e(n) = Q[x(n)] - x(n)$

经验公式：信噪比

输入x(n)不含噪声，输出Q[x(n)]中仅考虑量化噪声，x(n)的平均功率用$\sigma_x^2$表示

$\frac{S}{N} = 6.01b + 10.79 + 101g\sigma_x^2$ (dB)

#### 离散时间信号的傅里叶变换（DTFT）

$X(e^{j\omega}) = \sum$

幅度相位都要记住

![](11.png)

- CTFT：连续时间、非周期信号
- DTFT：离散时间、非周期信号
- CFS：连续时间、周期信号
- DFS：离散时间、周期信号      ==计算机用的==

![](12.png)

#### 离散傅里叶变换（DFT）

离散的周期信号的傅里叶变换

将有限长序列x(n)拓成周期序列$\tilde{x}(n)$

DFT 和 IDFT 的矩阵形式

傅里叶变换本质上是一个正交变换矩阵

快速傅里叶变换 $X(k) = DFT[x(n)] = \sum_{n=0}^{N-1}x(n)W_N^{kn}$

FFT计算量从$N^2$降低到$\frac{N}{2*log^N_2}$

Radix基（几维）

考试考过的

八点FFT

### DFT定义

![](13.png)

补零操作可以使谱的外观得到平滑

DDL 4.24

词表：30个词

录音 每个词朗读20遍

文件格式		学号-数字-01.dat ~ 学号-数字-20.dat

上传

## Z变换

单边Z变换为0~正无穷

![](14.png)

Z变换 —— 该序列乘以一个实加权序列后的傅里叶变换

R=1时Z变换就变为DTFT，或者说DTFT是单位元上Z变换

**零点与极点**

常用的Z变换是一个有理函数
$$
X(z) = \frac{P(z)}{Q(z)}
$$
零点：P(z)的根

极点：Q(z)的根

- Z平面上那些能使X(Z) 收敛的点的集合，就构成了X(Z) 的收敛域
- 单位圆在收敛域里，DTFT才存在
- 不同的x的能会导致同样的Z变换，所以要把收敛域加入考虑，保证逆唯一
- 双边序列的ROC是Z平面上一个以原点为中心的圆环

因果序列 圆外

反因果序列 圆

双边序列 圆环

有限长序列 平面（或除原点）

![](15.png)

### Z反变换

- 幂级数法

  长除法

- ==部分分式法==

- 留数法

![](16.png)

### 用Z变换分析信号与系统

因果稳定线性时不变系统：

- 是因果序列
- 绝对可和

稳定系统——H(z)的ROC必须包含单位圆（就那根线，不是整个圆）

### 线性时移不变系统的表示

差分方程表示

Z变换：在已知收敛域的条件下，系统函数H(z)由系数Bm,Ak决定.

### 数字滤波器

低通、带通、高通、带阻、全通

#### 低通滤波器

最高的频率成分先确定，再采样（符合采样定理）

通带 - 过渡带 - 阻带

频率0 - pi, pi - 2pi对称，频率不超过pi



### 广义平稳

### 预测原理

​	**线性预测**: 

​	**线性预测误差:**

​	最小化误差能量函数。预测误差能量En=  $\sum_n e^2(n)$

​	求解预测系数，偏导 =  0；p个未知数，p个方程组

计算：

1. 自相关函数（假定窗口以外信号=0） 【需要掌握，xxx矩阵，递归求解】
2. 协方差法

A(Z)

### 线谱对

**线谱对的计算：** 怎么算$\theta_i, \omega_i$

单位圆等分找零点位置

LST（调包）



# 频域分析

03-sp+f+domain+analysis+v2

语音识别主要特征MFCC

## 叠加原理

### 利用叠加原理分离信号

假设两个信号的频谱不重叠，可用线性滤波方法分离信号。

### 广义叠加原理

加法可以用卷积代替

## 卷积同态系统

### 卷积同态系统的实现方法

#### 卷积同态系统

$ x_1(n) * x_2(n) \stackrel{z}{\longrightarrow} x_1(z) \cdot  x_2(z)\stackrel{lg}{\longrightarrow} lg(x_1(z)) + lg(x_2(z)) = \hat{x}_2(x) + \hat{x}_2(x)$

$z^{-1}[\hat{X}(z)] = z^{-1}[\hat{X}_1(z)] + z^{-1}[\hat{X}_2(z)] = \hat{x}_1(x)+\hat{x}_2(x)$

目的：把e(n),h(n),r(n)分离开来



$s(n) = e(n) * h(n)$

$s(e) = e(z) \cdot h(z)$

对信号进行分解，卷积得到—>分开

激励语言 (周期脉冲)+ 声道系统

#### 卷积同态系统的逆特征系统



## 复倒谱和倒谱

### 定义

负对数函数的多值性问题

如果a为正数，b为负实数，那么log(ab) = ?

$ln(ab) = ln(a|b|e^{jk\pi}) = ln(a) + ln(|b|) + jk\pi$，k为奇数。

信号的复倒谱另一种形式

### 实倒谱

扔掉相位角

$\hat{x(n)} = Z^{-1}\{|n(Z[x(n)])|\} = \hat{x_1(n)} + \hat{x_2(n)}$

### 复倒谱的计算方法

避开复数的对数运算 $\hat{X}(e^{j\omega}) = ln X(e^{j\omega})$

相位缠绕 $\phi(\omega) = \phi_1(\omega) + \phi_2(\omega)$

**缺点**：高频分量多，如果仍按照原采样频率进行分析，将会导致频率混叠问题



由声门激励的倒谱可得：一个周期冲激的有限长序列，其倒谱也是周期冲激序列，且周期长度不变，信号长度成为无限长，振幅随k衰减。当激励为浊音时，倒谱只在kNp上不等于零，其他均为零

### 倒谱的基本原理

时域信号 → DFT → 信号频谱 → ln|·| → 对数谱 → 逆DFT → 倒谱

## MFCC

### 人的听觉系统特性

人耳听到的声音高低与声音频率不呈线性关系

$B(f) = 2595log_{10}(1 + f/700)$

人的听觉不能有效分辨所有频率分量——屏蔽效应

Mel频率尺度：对数关系

Mel滤波器组：屏蔽效应

频率较低时窗口比较小，频率较大时窗口较大

12（足够），16窗（更精细） —— 向量

一个滤波器的起点是另一个的中点

中心频率$f_c(m) = (\frac{N}{F_x})B^{-1}(B(f_1)+m\frac{B(f_n)-B(f_1)}{M+1})$

于是得到了M个带通滤波器$H_m(k)$

MFCC的定义

$log|S(e^{j\omega})| = \sum_{m=-\infty}^\infty c_me^{-j\omega m}$

$S(\omega) = lim_{}$

DCT是

**过程**

- 预加重、分帧、加窗
- 用FFT计算信号频谱
- 计算频谱的绝对值或平方
- Mel滤波器组
- 取对数
- DCT（逆DFT的实部）
- Delta MFCC

计算相邻语音帧的MFCC的变化Delta MFCC能更好表达语音特征



## 语音识别

非特定人小词汇量关键词识别

识别方法：

- 模板匹配法（VQ，DTW）
- 统计模型法（隐马尔科夫模型HMM）

具体原理：

​					      失真测度

​						     ↓

预处理 → 声学参数分析 → 测度估计 → 判决

​						     ↑

​						语音库

预处理：

- 反混叠失真滤波器
- 预加重器
- 端点检测
- 噪声滤波器

声学参数分析：

- 平均能量
- 过零率
- LPC系数及倒谱
- Mel倒谱
- LSP

时间长度一致 （同样长度向量）→ VQ（计算距离） 

失真测度d

- 正值性
- 对称性
- 三角不等式

动态时间弯曲DTW 将时间进行缩放配对

## 复习

- 卷积和卷积性质（上下界）

- DTFT离散时间信号傅里叶变换，理解共识，能写出来

  正变换；反变换，离散时间信号会不会算

  会证明吗？

  傅里叶分析的四种情况

- DFT蝶形计算图

- Z变换

- 语音产生机理

- 线性产生模型

- 短时傅里叶变换STFT

- 语音时间分析

  - 短时能量
  - 短时平均过零率
  - 短时自相关系数
  - 端点检测
  - 浊清静音分辨
  - 基音估计

- 复倒谱

- MFCC

- 基于VQ的语音识别方法（不一定考！）

- HMM计算

- HMM语音识别
