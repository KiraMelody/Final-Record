## 网络安全

- 网络安全问题
- 网络攻击防护
- 防火墙
- 入侵检测
- 网络隔离
- 公钥基础设施和权限基础设施
- 网络安全协议
- IPv6新一代网络的安全机制

网络攻击步骤

1. 隐藏攻击源
   - 利用被侵入的主机（肉鸡）作为跳板进行攻击
   - 使用多级代理，留下代理计算机的IP
   - 伪造IP账号
   - 假冒用户账号
2. 信息搜集
   - 确定攻击目标
   - 踩点，收集相关信息
   - 扫描，利用扫描工具在攻击目标的IP地址的主机上找漏洞
   - 怎么反扫描？
3. 掌握系统控制权
   - 一般账户对目标系统只有有限的访问权限，要达到攻击目的，必须得到系统或管理员权限
   - 获取系统管理权限的方法：扫描系统漏洞、系统口令猜测、种植木马、会话劫持
4. 实施攻击
   - 下载敏感信息
   - 攻击其他被信任的主机和网络
   - 瘫痪网络
   - 修改或删除重要信息
5. 安装后门
   - 放宽文件许可权
   - 重新开放不安全的服务
   - 修改系统的配置
   - 替换系统本身的共享库文件
   - 安装各种木马
6. 隐藏攻击痕迹
   - 清除或篡改日志文件
   - 改变系统时间
   - 代理跳板

TCP/IP的安全问题

应用层，传输层，网络层，网络接口层

对应OSI的7层

![](a1.png)

1. 网络接口层。网络接口层有时又称数据链路层，一般负责处理通信介质的细节问题，如设备驱动程序、以太网(Ethernet)、令牌环网(Token Ring)。ARP和RARP协议负责IP地址和网络接口物理地址的转换工作。

2. 网络层。该层负责处理网络上的主机间路由及存储转发网络数据报。IP是网络层的主要协议，提供无连接、不可靠的服务。IP还给出了因特网地址分配方案，要求网络接口必须分配独一无二的IP地址。同时，IP为ICMP、IGMP 以及TCP和UDP等协议提供服务。

3. 传输层。该层负责提供源主机、目的主机的应用程序间的数据流通信服务。TCP/IP协议在此层定义了TCP和UDP协议。TCP提供可靠的数据流通信服务。TCP的可靠性由定时器、计数器、确认和重传来实现。与TCP处理不同的是，UDP不提供可靠的服务，其主要的用处在于应用程序间发送数据。UDP数据包有可能丢失、复制和乱序。

4. 应用层。该层包含多种高层协议。几乎每一个TCP/IP的实现都提供许多公开的应用。

   HTTP：超文本传递协议，提供浏览器和WWW服务间有关HTML文件传递服务。

   FTP：文件传输协议，提供主机间数据传递服务。

   Telnet：虚拟终端协议，提供远程登录服务。

   SMTP：简单的电子邮件传送服务协议，提供发送电子邮件服务。

   DNS：域名系统完成域名的解析。

   此外，还有POP3、OSPF、NFS等其他的许多应用协议。

### ARP协议的安全问题（地址解析协议ARP）

#### 网络接口层（链路层）的概念

- 链路(link)是一条无源的点到点的物理线路段，中间没有任何其他的交换结点。
- 一条链路只是一条通路的一个组成部分。
- 数据链路(data link) 除了物理线路外，还必须有通信协议来控制这些数据的传输。若把实现这些协议的硬件和软件加到链路上，就构成了数据链路。
- 现在最常用的方法是使用适配器（即以太网卡或802.11无线）来实现这些协议的硬件和软件。
- 一般的适配器都包括了数据链路层和物理层这两层的功能。

#### 地址解析ARP

- 不管网络使用什么协议，在实际的链路上传送必须使用硬件地址
- 每一个主机都有一个ARP高速缓存，有局域网上的各主机和路由器的IP地址到硬件地址的映射表
- 当主机A向B发送IP数据报时，就现在起ARP cache上查看有无B的IP地址，如有，可查出其对应的硬件地址，在将此硬件地址写入MAC帧，然后通过局域网将该MAC帧发往此硬件地址

**弱点**

- ARP作为一个局域网协议，建立在各个主机之间相互信任的基础上，存在安全问题
- 主机地址映射表基于高速缓存、动态更新。由于正常主机间的MAC地址刷新有时限，恶意用户如果在下次交换前成功修改了被欺骗机器上的地址缓存，就可以进行假冒或者拒绝服务攻击。
- 可以随意发送ARP应答分组。由于ARP协议是无状态的，任何主机即使在没有请求的时候也可以做出应答，因此任何时候都可以发送ARP应答。只要应答分组是有效的，接收到ARP应答分组的主机就无条件地根据应答分组的内容刷新本机的高速缓存。
- 可以随意发送ARP应答分组。由于ARP协议是无状态的，任何主机即使在没有请求的时候也可以做出应答，因此任何时候都可以发送ARP应答。只要应答分组是有效的，接收到ARP应答分组的主机就无条件地根据应答分组的内容刷新本机的高速缓存。

**攻击原理**

- 缓存表的作用是提高网络效率、减少数据延迟。然而易信任性，不对正确性做审查。发送未被请求的ARP应答报文，对于大多数操作系统，主机收到ARP应答报文后立即更新ARP缓存，因此直接发送伪造ARP 应答报文就可以实现ARP欺骗。
- 发送ARP请求报文。主机可以根据局域网中其他主机发送的ARP请求来更新自己的ARP缓存。因此，攻击者可以发送一个修改了源IP-MAC映射的ARP请求来实现ARP欺骗
- 响应一个请求报文

怎么判断：对缓存表发请求，发现多个回应，一定被攻击

**常见形式**

- 中间人攻击
- 拒绝服务攻击

局域网内的主机要与外网进行通信，必须经过局域网与外网之间连通的节点——网关。由于存在这个“主机必须与之通信的理由”，将网关的IP地址与错误的MAC地址对应，就成了大部分ARP欺骗行为所选择的做法。

利用网关的IP地址进行的ARP欺骗，其危险之处在于，攻击者可以借此控制用户主机的网络数据流向，即可以指定用户主机向哪一个MAC地址发送数据，比如：

1）指向一个无效的MAC地址

这使得用户主机发送的网络数据“石沉大海”，发出去的信息无法得到回应。访问网关的失败，将导致用户没有办法与外网进行通信。

2）指向攻击者设置好的MAC地址

这种做法会让用户主机发送的网络数据传到了原本不应该传输的地方。MAC地址所对应的主机，将接收到原本应该被发到网关的网络数据。如果收到数据的主机直接丢弃数据，结果就是被欺骗主机得不到回应，不能正常上网。

而如果收到数据的主机，对数据内容进行分析处理，就可能从中得到被欺骗主机用户的隐私信息比如账号、密码，这种行为危害性更大。当然，此时被欺骗主机并非一定得不到回应。因为接收到数据的“伪网关”可以选择充当起“真网关”的替代者，成为数据的中转站，为用户向“真网关”呼叫，用户仍可以收到“真网关”经由“伪网关”传来的回应数据。

#### ARP攻击的防范

蜜罐：可控假目标

不用的IP地址，设成假目标，等外部人员发起探测

```
蜜罐系统是一个陷阱系统，它通过设置一个具有很多漏洞的系统吸引黑客入侵，收集入侵者信息，为其他安全技术提供更多的知识。蜜罐采用监视器和事件日志两个工具对访问蜜罐系统的行为进行监控。由于蜜罐是一个很具有诱惑力的系统，能够分散黑客的注意力和精力，所以对真正的网络资源起到保护作用。
```

### IP层的安全问题

基于RIP（路由选择协议，实质上实现的是距离向量算法）的欺骗

- 由于TCP/IP协议使用IP地址作为网络节点的惟一标识，其数据包的源地址很容易被发现，且IP地址隐含所使用的子网掩码，攻击者据此可以画出目标网络的轮廓。因此，使用标准IP地址的网络拓扑对因特网来说是暴露的。IP地址也很容易被伪造和被更改，且TCP/IP协议没有对IP包中源地址真实性的鉴别机制和保密机制。因此，因特网上任一主机都可产生一个带有任意源IP地址的IP包，从而假冒另一个主机进行地址欺骗。
- IP层本身不提供加密传输功能，用户口令和数据是以明文形式传输的，很容易在传输过程中被截获或修改。
- 在IP层上同样缺乏对路由协议的安全认证机制，因此对路由信息缺乏鉴别与保护。路由欺骗有多种方法，都是通过伪造路由表欺骗。例如，基于RIP的欺骗。RIP是现代计算机网络使用的路由选择协议，实质上实现的是距离——向量算法：每个Active 网络节点周期性的发送它的路由信息到邻居Passive节点，用这些路由信息，每个节点计算出到其他节点的最短路由，代替原有路由，由于这种信任使RIP欺骗成为可能，即通过使用RIP特权的主机广播非法路由信息就可以达到欺骗的目的。

### 传输层的安全问题

从通信和信息处理的角度看，传输层向它上面的应用层提供通信服务，它属于面向通信部分的最高层，同时也是用户功能中的最低层。 

- 两个主机进行通信实际上就是两个主机中的应用进程互相通信。
- 应用进程之间的通信又称为端到端的通信。
- 传输层的一个很重要的功能就是复用和分用。应用层不同进程的报文通过不同的端口向下交到运输层，再往下就共用网络层提供的服务。
- “传输层提供应用进程间的逻辑通信”。“逻辑通信”的意思是：传输层之间的通信好像是沿水平方向传送数据。但事实上这两个传输层之间并没有一条水平方向的物理连接。

![](a2.png)

传输层的主要功能

- 传输层为应用进程之间提供端到端的逻辑通信（但网络层是为主机之间提供逻辑通信）。
- 传输层还要对收到的报文进行差错检测。
- 传输层需要有两种不同的传输协议，即面向连接的TCP 和无连接的UDP。

TCP/IP的运输层有两个不同的协议：

(1) 用户数据报协议UDP(User Datagram Protocol)

(2) 传输控制协议TCP(Transmission Control Protocol)

- UDP 在传送数据之前不需要先建立连接。对方的运输层在收到UDP 报文后，不需要给出任何确认。虽然UDP 不提供可靠交付，但在某些情况下UDP 是一种最有效的工作方式。
- TCP 则提供面向连接的服务。TCP 不提供广播或多播服务。由于TCP 要提供可靠的、面向连接的运输服务，因此不可避免地增加了许多的开销。这不仅使协议数据单元的首部增大很多，还要占用许多的处理机资源。   

端口的概念

端口的作用就是让应用层的各种应用进程都能将其数据通过端口向下交付给运输层，以及让运输层知道应当将其报文段中的数据向上通过端口交付给应用层相应的进程。

从这个意义上讲，端口是用来标志应用层的进程。

端口用一个16 bit 端口号进行标志。

端口号只具有本地意义，即端口号只是为了标志本计算机应用层中的各进程。在因特网中不同计算机的相同端口号是没有联系的。

![](a3.png)



#### UDP概述

UDP只在IP的数据报服务之上增加了很少一点的功能，即端口的功能和差错检测的功能。

虽然UDP用户数据报只能提供不可靠的交付，但UDP 在某些方面有其特殊的优点。

- 发送数据之前不需要建立连接
- UDP 的主机不需要维持复杂的连接状态表。
- UDP 用户数据报只有8个字节的首部开销。
- 网络出现的拥塞不会使源主机的发送速率降低。这对某些实时应用是很重要的。     

#### TCP概述

- TCP 协议是面向字节的。TCP 将所要传送的报文看成是字节组成的数据流，并使每一个字节对应于一个序号。
- 在连接建立时，双方要商定初始序号。TCP 每次发送的报文段的首部中的序号字段数值表示该报文段中的数据部分的第一个字节的序号。
- TCP的确认是对接收到的数据的最高序号表示确认。接收端返回的确认号是已收到的数据的最高序号加1。因此确认号表示接收端期望下次收到的数据中的第一个数据字节的序号。
- TCP 的连接和建立都是采用客户服务器方式。主动发起连接建立的应用进程叫做客户(client)。被动等待连接建立的应用进程叫做服务器(server)。

**三次握手建立TCP连接**

建立TCP连接

![](a4.png)

A的TCP向B发出连接请求报文段，其首部中的同步比特SYN应置为1，并选择序号x，表明传送数据时的第一个数据字节的序号是x。B的TCP收到连接请求报文段后，如同意，则发回确认。B在确认报文段中应将SYN置为1，其确认号应为x  1，同时也为自己选择序号y。A收到此报文段后，向B给出确认，其确认号应为 y 1。A的TCP通知上层应用进程，连接已经建立。当运行服务器进程的主机B的TCP收到主机A的确认后，也通知其上层应用进程，连接已经建立。 

怎么不应答：给一个假地址source IP，通过源地址认证的缺陷

### 应用层

1. Web服务的安全问题

   Web服务器上的漏洞一般可以分为以下几类：

   1）操作系统本身的安全漏洞。比如由于操作系统本身的漏洞，使得未授权的用户可以获得Web服务器上的秘密文件、目录或重要数据。

   2）明文或弱口令漏洞。如果客户机和服务器间的通信是明文或弱口令加密方式，那么传输的信息中途可能会被网络攻击者非法拦截而暴露。

   3）Web服务器本身存在的一些漏洞，或者IIS(运行于Windows下)和Apache(运行于Linux下)本身的漏洞，使得攻击者能侵入到主机系统，破坏一些重要的数据，甚至造成系统瘫痪。

   4）脚本程序的漏洞，这些漏洞给网络攻击者创造了条件。

   5）除了针对漏洞进行的攻击以外，Web欺骗也是一个发生频繁的安全问题。Web欺骗允许攻击者将对一个正常Web的访问流量全部引入到攻击者的Web服务器，经过攻击者机器的过滤作用，允许攻击者监控受攻击者的任何活动，包括账户和口令。攻击者也能以受攻击者的名义将错误或者易于误解的数据发送到真正的Web服务器，以及以任何Web服务器的名义发送数据给受攻击者。

2. FTP和TFTP服务的安全问题。

   这两个服务都是用于传输文件的，但应用场合不同，安全程度也不同。TFTP服务用于局域网，在无盘工作站启动时用于传输系统文件，安全性极差，常被人用来窃取密码文件/etc/passwd，因为它不带有任何安全认证。

3. Telnet的安全问题。

   Telnet本身存在很多的安全问题，主要有：

   1）传输明文。Telnet登录时没有口令保护，远程用户的登录传送的用户名和密码都是明文，传送的数据都没有加密，网络攻击者使用任何一种简单的嗅探器就可以截获。

   2）没有强力认证过程。验证的只是连接者的用户名和密码。

   3）没有完整性检查。传送的数据无法知道是否是完整的，不能判断数据是否被篡改过。

4. 电子邮件面临的安全问题有：

   1）邮件拒绝服务(邮件炸弹)

   2）邮件内容被截获。

   3）邮件软件漏洞非法利用。

   4）邮件恶意代码。

   5）邮箱口令暴力攻击(Brute Force)。

   6）垃圾邮件。

   7）用户邮箱地址泄漏。

5. 电子邮件面临的安全问题有：

   1）邮件拒绝服务(邮件炸弹)

   2）邮件内容被截获。

   3）邮件软件漏洞非法利用。

   4）邮件恶意代码。

   5）邮箱口令暴力攻击(Brute Force)。

   6）垃圾邮件。

   7）用户邮箱地址泄漏。

6. DNS的安全问题。

   1）域名欺骗。DNS通过客户服务器方式提供域名解析服务，但查询者不易验证请求回答信息的真实性和有效性。攻击者设法构造虚假的应答数据包，将网络用户导向攻击者所控制的站点，为用户提供虚假的网页，或者搜集用户的敏感数据，如邮件和网络银行账号。

   2）网络信息泄漏。域名服务器存贮大量的网络信息，如IP地址分配、主机操作系统信息、重要网络服务器名称等。假如域名服务器允许区域信息传递，就等于为攻击者提供了“目标网络拓扑图”。

   3）DNS服务器拒绝服务。域名服务器是因特网运行的基础服务，某个单位的域名受到破坏，则大部分网络用户就无法获得该单位提供的服务。

   4）远程漏洞。BIND服务器软件的许多版本存在缓冲区溢出漏洞，黑客可以利用这些漏洞远程入侵BIND服务器所在的主机，并以root身份执行任意命令。这种攻击的危害性比较严重，黑客不仅获得了DNS服务器上所有授权区域内的数据信息，甚至可以直接修改授权区域内的任意数据，同时可以利用这台主机作为攻击其它机器的“跳板”。关于这些漏洞的详细信息可以查看参考文献中所列的CERT安全建议。

## DDOS攻击

### SYN Flood攻击

SYN FLOOD攻击是最常见的一种攻击。在TCP的连接建立过程中，需要连接双方完成3次握手，只有当3次握手都顺利完成，一个TCP连接才告建立。在3次握手进行的过程中，服务器需要保持所有未完成的握手信息（称为半开连接，即收到TCP-SYN并发送了SYN-ACK，但第3次握手信息直到握手完成或超时以后丢弃该信息）。由于半开连接的数量是有限的，如果攻击者不停地向受害者发送连接请求，而又不按协议规定完成握手过程，则服务器的半开连接栈可能会用完，从而不再接受其它的连接请求。

### UDP Flood攻击

UDP 是一种无连接的协议，在传输数据之前不需要如TCP那样建立连接。当一个系统收到一个UDP分组时，它会检查何种应用程序在监听该端口，如果有应用程序监听，则把数据交给该应用程序处理，如果没有 应用程序监听该端口，则回应一个ICMP 分组说明目标不可达。UDP FLOOD通常的主要目的是占用网络带宽，达到阻塞网络的目的，因此通常UDP FLOOD攻击的数据分组会比较长。 

### Smurf攻击

攻击时，攻击者会向接收站点中的一个广播地址发送一个IP ICMP PING（即“请回复我的消息”）。PING 数据包随后将被广播到接收站点的本地网络中的所有主机。该数据包包含一个“伪装的”源地址，即该DOS攻击的对象的地址。每个收到此 PING 数据包的主机都会向伪装的源地址发送响应，从而导致这个无辜的、被伪装的主机收到大量的PING 回复。如果收到的数据量过大，这个被伪装的主机就将无法接收或者区分真实流量。

### Fraggle攻击

它与SMURF攻击类似，只是利用UDP协议。攻击者掌握着大量的广播地址，并向这些地址发送假冒的UDP包，通常这些包是直接到目标主机的7号端口——也就是ECHO端口，而另一些情况下它却到了CHARGEN端口，攻击者可以制造一个在这两个端口之间的循环来产生网络阻塞。

### Land攻击

采用目标和源地址相同的UDP包攻击目标。在LAND攻击中，一个特别打造的SYN包中的原地址和目标地址都被设置成某一个服务器地址，这时将导致接受服务器向它自己的地址发送SYN一ACK消息，结果这个地址又发回ACK消息并创建一个空连接，每一个这样的连接都将保留直到超时掉。对LAND攻击反应不同，许多UNIX实现将崩溃，而 WINDOWS NT 会变的极其缓慢（大约持续五分钟）。LAND 攻击发生的条件是攻击者发送具有相同IP源地址、目标地址和TCP端口号的伪造TCP SYN数据包信息流。必须设置好SYN标记。其结果是该计算机系统将试图向自己发送响应信息，而受害系统将会受到干扰并会瘫痪或重启。

## 防护系统

### 防火墙

防火墙是设置在不同网络(如可信任的企业内部网络和不可信的公共网络)或网络安全域之间的一系列部件的组合。

在逻辑上，防火墙是一个分离器，一个限制器，也是一个分析器，能有效地监控流经防火墙的数据，保证内部网络和DMZ(DemilitarizedZone，隔离区，或译作非军事区)的安全。

防火墙的定义：防火墙可以是软件、硬件或软硬件的组合。

不管什么种类的防火墙，不论其采用何种技术手段，防火墙都必须具有以下三种基本性质：是不同网络或网络安全域之间信息的唯一出入口；能根据网络安全策略控制(允许、拒绝、监测)出入网络的信息流，且自身具有较强的抗攻击能力；本身不能影响网络信息的流通。

DMZ网络是从内部网络中划分的一个小区域，其中包括内部网络中用于公众服务的服务器。在这个区域中，由于需要对外开放某些特定的服务和应用，因而网络受保护的级别较低，如果级别太高，则这些提供公共服务的网络应用就无法进行。在这个区域中的网络设备所运行的应用也非常单一。

- 边界防火墙

  处于外部不可信网络(包括因特网、广域网和其他公司的专用网)与内部可信网络之间，控制来自外部不可信网络对内部可信网络的访问，防范来自外部网络的非法攻击。同时，保证了DMZ区服务器的相对安全性和使用便利性。这是目前防火墙的最主要应用。

  - 通过对源地址过滤，拒绝外部非法IP地址，可避免外部网络主机的越权访问。
  - 关闭不必要的服务，可将系统受攻击的可能性降低到最小限度。
  - 可制订访问策略，使只有被授权的外部主机可以访问内部网络有限的IP地址，拒绝与业务无关的操作。
  - 由于防火墙是内、外部网络的唯一通信通道，因此防火墙可以对所有针对内部网络的访问进行详细的记录，形成完整的日志文件(包过滤型防火墙不具有此功能)。

- 内部防火墙

  处于内部不同可信等级安全域之间，起到隔离内网关键部门、子网或用户的目的。

  - 可以精确制订每个用户的访问权限，保证内部网络用户只能访问必要的资源。
  - 对于拨号备份线路的连接，通过强大的认证功能，实现对远程用户的管理。
  - 内部防火墙可以记录网段间的访问信息，及时发现误操作和来自内部网络其他网段的攻击行为。
  - 通过集中的安全策略管理，使每个网段上的主机不必再单独设立安全策略，降低了人为因素导致产生网络安全问题的可能性。

- 关键技术

  - 包过滤技术

    - 包过滤防火墙工作在网络层和传输层，它根据通过防火墙的每个数据包的首部信息来决定是将该数据包发往目的地址还是丢弃。

    - 大多数包过滤型防火墙只是针对性地分析数据包信息头的部分域。

    - 包过滤规则表定义了什么包可以通过防火墙，什么包必须丢弃。这些规则常称为数据包过滤访问控制列表（ACL）

    - 当数据流进入包过滤防火墙后，防火墙检查数据包的相关信息，开始从上至下扫描过滤规则，如果匹配成功则按照规则设定的操作执行，不再匹配后续规则。所以，在访问控制列表中规则的出现顺序至关重要。

    - 访问控制列表的配置有两种方式。

      ▷严策略。接受受信任的IP包，拒绝其他所有IP包。

      ▷宽策略。拒绝不受信任的IP包，接受其他所有IP包。

      在实际应用中一般采用严策略来设置防火墙规则。

      包过滤防火墙规则中还应该阻止如下几种IP包进入内部网。

      ▷源地址是内部地址的外来数据包。

      ▷指定中转路由器的数据包。

      ▷有效载荷很小的数据包。

      还应阻止某些类型的内部网数据包进入外部网，特别是那些用于建立局域网和提供内部网通信服务的各种协议数据包

    - 优点：在于处理效率上，其安全性体现在根据过滤规则对TCP、UDP数据包进行检测

      缺点：判别过滤的依据只是网络层和传输层的有限信息，因而不可能满足各种安全要求。大多数过滤器中缺少审计和报警机制，只能依据包头信息，而不能对用户身份进行验证，很容易遭受欺骗型攻击。在许多型号的防火墙过滤器中，过滤规则的数目有限制，随着规则数目的增加，防火墙性能会受到很大的影响。对安全管理人员的要求高，在建立安全规则时，必须对协议本身及其在不同应用程序中的作用有较深入的了解。由于缺少上下文关联信息，不能有效地过滤如UDP、RPC、Telnet一类的协议以及处理动态端口连接。

  - 状态包过滤技术

    - 一种基于连接的状态检测机制，将属于同一连接的所有包作为一个整体的数据流看待，对接收到的数据包进行分析，判断其是否属于当前合法连接，从而进行动态的过滤。

    - 状态包过滤同时维护过滤规则表和状态表

    - 状态数据包过滤防火墙比传统数据包过滤具有更强的安全能力。但是，在应用中依然存在着以下一些问题。

      ▷访问控制列表的配置和维护困难。

      ▷包过滤防火墙难以详细了解主机之间的会话关系。

      ▷基于网络层和传输层实现的包过滤防火墙难以实现对应用层服务的过滤。

      ▷由于必须查询状态表，状态数据包过滤防火墙的性能会受到一定影响。

  - NAT网络地址转换技术

    - 网络地址转换（NetworkAddress Translation，NAT），也称IP地址伪装技术（IPMasquerading）。

      最初设计NAT的目的是允许将私有IP地址映射到公网（合法的因特网IP地址），以减缓IP地址短缺的问题。正是因为这个原因，我们至今还能使用IPv4，否则早就已经升级到IPv6了。

      此外，NAT还具有的功能。

      ▷内部主机地址隐藏。

      ▷网络负载均衡。

      ▷网络地址交迭处理。

    - NAT技术的缺点

      1）一些应用层协议的工作特点导致了它们无法使用NAT技术。当端口改变时，有些协议不能正确执行它们的功能。

      2）静态和动态NAT安全问题。

      3）对内部主机的引诱和特洛伊木马攻击。通过动态NAT可以使得黑客难以了解网络内部结构，但是无法阻止内部用户主动连接黑客主机。如果内部主机被引诱连接到一个恶意外部主机上，或者连接到一个已被黑客安装了木马的外部主机上，内部主机将完全暴露，就像没有防火墙一样容易被攻击。

      4）状态表超时问题。

  - 代理技术

    - 代理防火墙不再围绕数据包，而着重于应用级别，分析经过它们的应用信息，决定是传送或是丢弃。代理服务一般分为应用层代理与传输层代理两种。

    - 应用层代理也称为应用层网关（ApplicationGateway）技术，工作在网络体系结构的最高层——应用层。

      应用层代理使得网络管理员能够实现比包过滤更加严格的安全策略。

      应用层代理不用依靠包过滤工具来管理进出防火墙的数据流，而是通过对每一种应用服务编制专门的代理程序，实现监视和控制应用层信息流的作用。

      防火墙可以代理HTTP、FTP、SMTP、POP3、Telnet等协议，使得内网用户可以在安全的情况下实现浏览网页、收发邮件、远程登录等应用。

    - 采用应用层网关技术的防火墙还有以下优点。

      ▷应用层网关有能力支持可靠的用户认证并提供详细的注册信息。

      ▷用于应用层的过滤规则相对于包过滤防火墙来说更容易配置和测试。

      ▷代理工作在客户机和真实服务器之间，完全控制会话，所以可以提供很详细的日志和安全审计功能。

      ▷提供代理服务的防火墙可以被配置成惟一的可被外部看见的主机，这样可以隐藏内部网的IP地址，可以保护内部主机免受外部主机的进攻。

      ▷通过代理访问因特网可以解决合法IP地址不够用的问题，因为因特网所见到只是代理服务器的地址，内部的IP则通过代理可以访问因特网。

    - 缺点

      ▷当用户对内外网络网关的吞吐量要求比较高时，代理防火墙就会成为内外网络之间的瓶颈。

      ▷有限的连接性。

      ▷有限的技术。

  - VPN虚拟专用网技术

    - VPN提供一种在现有网络或点对点连接上建立一至多条安全数据信道的机制。它只分配给受限的用户组独占使用，并能在需要时动态地建立和撤销。主机网络可为专用的或公共的。

    - VPN的功能

      一个虚拟专用网络至少应该能提供如下功能。

      ▷数据加密：保证通过公共网络传输的数据即使被他人截获也不至于泄露信息。

      ▷信息认证和身份认证：保证信息的完整性、合法性和来源可靠性（不可抵赖性）。

      ▷访问控制：不同的用户应该分别具有不同的访问权限。

- 防火墙技术

  1. 所有进出被保护网络的通信必须通过防火墙

  2. 所有通过防火墙的通信必须经过安全策略的过滤或者防火墙的授权

  3. 防火墙本身是不可被入侵的 

  4. 局限性

     1）防火墙防外不防内。

     2）防火墙的管理及配置比较复杂，易造成安全漏洞。

     3）很难为用户在防火墙内外提供一致的安全策略。

     4）防火墙粗粒度的访问控制带来的维护复杂性。

     5）使用防火墙可能会成为网络的瓶颈。

     6）使用应用代理防火墙时必须不断地设法获得新出现服务的应用代理。

     7）防火墙防范病毒的能力有限。

     8）大量潜在的后门使得防火墙失效。

     9）防火墙本身存在漏洞。

     - 包过滤型防火墙

       对内部主机和外部主机之间的网络数据包进行过滤，过滤系统可以是一台路由器，也可以是一台主机

       包过滤往往通过过滤路由器实现

       路由器审查每个数据包，以便确定其是否与其某一条包过滤规则匹配

       包头信息中包括IP原地址，IP目的地址，协议，TCP/UDP端口。。。

     - 双宿网关防火墙

       一种拥有两个连接到不同网络上网络接口的防火墙

     - 屏蔽主机防火墙

       强迫所有的外部主机与一个堡垒主机相连接

     - 屏蔽子网防火墙

       两个包过滤路由器和一个堡垒主机

       堡垒主机最容易受到攻击

- 入侵检测技术

  用于检测损害或企图损害网络系统的机密性、完整性或可用性等行为的一类安全技术。这类技术通过在受保护网络或系统中部署检测设备，监事受保护网络或系统。

  入侵检测顾名思义，是指通过对计算机网络或计算机系统中的若干关键点收集信息并对其进行分析，从中发现网络或系统中是否有违反安全策略的行为和被攻击的迹象。

  入侵检测的软件与硬件的组合便是入侵检测系统(IntrusionDetection System，简称IDS)。

  一个入侵检测系统（IDS）需要解决三方面的问题：第一，需要充分并可靠地采集网络和系统中的数据、提取描述网络和系统行为的特征；其次，必须根据以上数据和特征，高效并准确地判断网络和系统行为的性质；最后，需要对网络和系统入侵提供响应手段。

  IDS 至少分为数据源、分析检测和响应三个模块。数据源模块为分析检测模块提供网络和系统的相关数据和状态。分析检测模块执行入侵检测后，将结果提交给响应模块，后者采取必要的措施，以阻止进一步的入侵或恢复受损害的系统。在以上过程中，检测支持数据库起关键作用。它存储入侵行为的特征模式，一般称为入侵模式库。

  - 基于主机的IDS 

    检测目标主要是主机系统和系统的本地用户，可以运行在被检测的主机或单独的主机上，根据主机的审计数据和系统日志发现可疑迹象。基于主机的IDS 对于监重要服务器的安全状态并做及时的响应，具有很大的价值。但是，这类IDS 依赖于审计数据和系统日志，也存在明显的缺点。首先，审计数据和系统日志容易被清除或修改；其次，攻击者可能使用某些特权操作或低级操作逃避审计；最后，这类IDS 仅仅分析审计数据和系统日志，一般不能发现网络攻击和在审计范围之外的系统攻击。

  - 基于网络的IDS 

    主要根据网络流量、单台或多台主机的审计数据和日志检测入侵。其中，一个或多个探测器负责采集网络的数据流，被采集的数据被初步处理后，送给分析检测模块。值得注意的是，一般网络适配器都存在所谓的混杂模式，不但可以接收发到它的物理地址的数据包，也可以收听同一网段上发往其他地址的数据包。因此，探测器不需要像防火墙那样割断和转发全部流量，而仅仅将流量旁路出来。

  - 分析检测方法是指IDS 

    根据已有的知识，判断网络和系统是否遭受攻击及遭受何种攻击的方法。当前，主流的分析检测方法包括误用检测和异常检测两类，但也出现了一些新的方法（主要包括免疫方法、基因方法、数据挖掘和代理方法等），从不同方面丰富了入侵检测技术。

- 入侵防御系统

  单独的防火墙和IDS等技术不能对网络入侵行为实现快速、积极的主动防御。

  入侵防御系统IPS(IntrusionPrevention System，也称作IntrusionDetection Prevention，即IDP)作为IDS的替代技术。

  IPS是一种主动的、智能的入侵检测、防范、阻止系统，其设计旨在预先对入侵活动和攻击性网络流量进行拦截，避免其造成任何损失，而不是简单地在恶意流量传送时或传送后才发出警报。它部署在网络的进出口处，当它检测到攻击企图后，它会自动地将攻击包丢掉或采取措施将攻击源阻断。

  IPS与IDS在检测方面的原理相同。它们的区别主要在于：自动阻截和在线运行。

  - 关键技术

    - 主动防御技术
    - 防火墙和IPS联动技术
    - 集成多种检测方法
    - 硬件加速系统

  - 面临的问题及发展前景

    1）单点故障。

    2）性能瓶颈。绝大多数高端IPS产品供应商都通过使用自定义硬件FPGA、网络处理器和ASIC芯片来提高IPS的运行效率。

    3）误报和漏报。

- 安全网关技术

  安全网关一般部署在内部网络与外部网络的边界，主要用来抵御来自外部网络的安全威胁。这里所指的安全网关是传统意义上的单一功能安全网关。常见的安全网关有VPN网关、入侵防御网关、防病毒网关和基于密级标识的保密网关。

  - VPN网关

    外部用户访问内部主机或服务器时，为了保证用户身份的合法性、确保网络的安全，一般在网络边界部署VPN（虚拟网）网关，主要作用就是利用公共网络把多个网络节点和私有网络连接起来。

    针对不同的用户要求，VPN 网关有三种解决方案：远程访问虚拟网、企业内部虚拟网和企业扩展虚拟网，分别与传统的远程访问网络、企业内部Internet 网络和企业网络相对应。

    典型的VPN 网关继承了包过滤防火墙和应用代理防火墙的功能。某些VPN 网关从防火墙技术发展而来，防火墙的功能特性已经成为它基本功能集的一部分。

  - 入侵防御网关

    入侵防御网关以在线方式部署，实时分析链路上的传输数据，对隐藏在其中的攻击行为进行阻断，关注的是深层防御、精确阻断，以解决用户面临的边界入侵威胁，进一步优化网络边界安全。

    入侵防御网关一般串行部署在网络边界，以边界防护设备的形式接入网络，任何受保护网络的访问数据都将穿过入侵防御网关。与旁路的IDS 相比，入侵防御网关可以进行实时防御；与基于静态规则进行边界防护的防火墙相比，入侵防御可以实现动态深层次的、精确的防御。

  - 防病毒网关

    防病毒网关技术包括两个部分，一是对进出网关的数据进行查杀，二是对查杀的数据进行检测和清除。当前防病毒网关产品，对数据的病毒检测还是以特征码匹配技术为主，扫描技术及病毒库与其服务器版反病毒产品是一致的。因此，如何对进出网关的数据进行查杀，是网关防病毒技术的关键。由于国内外防病毒技术还无法对数据包进行病毒检测，所以在网关处只能采取将数据包还原成文件的方式进行病毒处理。最终对数据进行扫描，仍是通过病毒扫描引擎实现的。

- UTM技术

  - UTM可以说是将防火墙、IDS系统、防病毒和脆弱性评估等技术的优点与自动阻止攻击的功能融为一体。
  - 2004 年9 月，互联网数据中心（IDC）首度提出“统一威胁管理”的概念，即将防病毒、入侵检测和防火墙安全设备，划归统一威胁管理(Unified Threat Management，简称UTM)新类别。目前，UTM 常定义为由硬件、软件和网络技术组成的具有专门用途的设备。它主要提供一项或多项安全功能，同时将多种安全特性集成于一个硬件设备里，形成标准的统一威胁管理平台。UTM 设备应该具备的基本功能包括网络防火墙、网络入侵检测/ 防御和网关防病毒功能。
  - 总体上，UTM 取代了防火墙、网络入侵防御系统、防病毒网关、反垃圾邮件网关等大多数传统安全网关。UTM 的出现使串联式部署的多种安全产品得到有效整合，在网络边界建立了强大的立体防线。UTM 具有入侵检测功能，但是，UTM 是串联网关式的防御阻断类产品，入侵检测是旁路监听式产品，两者的部署方式和所起作用是不同的。
